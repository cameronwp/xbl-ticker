<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XBL Ticker v2</title>
  <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet'>

  <style>
    :root {
      --ticker-height: 36px;
      --league-width: 50px;
      --score-width: 650px;

      --score-box-cycle: 480s;
    }

    body {
      background-color: #00ff00;
      margin: 0;
      box-sizing: border-box;
    }

    .border-left {
      border-left: 2px solid white;
    }

    .border-right {
      border-right: 2px solid white;
    }

    .container {
      position: absolute;
      left: 0;
      bottom: 0;

      height: var(--ticker-height);
      width: 100%;

      display: flex;

      background-color: #323c4d;

      font-family: 'Oswald';
      font-size: 1.5rem;
      color: white;

      overflow-y: hidden;
    }

    .league {
      width: var(--league-width);
      height: 36px;
    }

    .league-logo-container {
      height: 36px;
    }

    .league-logo {
      height: 28px;
      margin-top: 4px;
    }

    .score-box {
      width: var(--score-width);
    }

    /* aligned with vertical-scroll-36 */
    .vertical-scroll-3 {
      animation: vertical-scroll-3 var(--score-box-cycle) ease 0s infinite forwards;
    }

    .vertical-scroll-36 {
      animation: vertical-scroll-36 var(--score-box-cycle) ease 0s infinite forwards;
    }

    .vertical-scroll-60 {
      animation: vertical-scroll-60 var(--score-box-cycle) ease 0s infinite forwards;
    }

    .matchup {
      display: flex;
    }

    .winner {
      color: yellow;
    }

    .marquee {
      width: calc(1920px - var(--league-width) - var(--score-width));
    }

    .team {
      display: flex;
      justify-content: space-between;

      width: calc(var(--score-width) / 2);
      padding: 0 4px;
    }

    .team-logo {
      margin-top: 4px;
    }

    .team-info {
      display: flex;
      justify-content: flex-start;
    }

    .team-name {
      padding-left: 0.5em;
    }

    @keyframes vertical-scroll-3 {

      0% {
        transform: translateY(calc(var(--ticker-height) * 1));
        opacity: 0;
      }

      0.4%,
      32.03703703703704% {
        transform: translateY(calc(var(--ticker-height) * 0));
        opacity: 1;
      }

      34.255401234567906%,
      63.65740740740742% {
        transform: translateY(calc(var(--ticker-height) * -1));
        opacity: 1;
      }

      65.87577160493828%,
      99.6% {
        transform: translateY(calc(var(--ticker-height) * -2));
        opacity: 1;
      }

      100% {
        transform: translateY(calc(var(--ticker-height) * -3));
        opacity: 0;
      }
    }

    /* generated by calc-keyframes.py */
    @keyframes vertical-scroll-60 {
      0% {
        transform: translateY(calc(var(--ticker-height) * 1));
        opacity: 0;
      }

      0.4166666666666667%,
      1.6180555555555556% {
        transform: translateY(calc(var(--ticker-height) * -0));
        opacity: 1;
      }

      2.0347222222222223%,
      3.236111111111111% {
        transform: translateY(calc(var(--ticker-height) * -1));
        opacity: 1;
      }

      3.6527777777777777%,
      4.854166666666666% {
        transform: translateY(calc(var(--ticker-height) * -2));
        opacity: 1;
      }

      5.270833333333333%,
      6.472222222222221% {
        transform: translateY(calc(var(--ticker-height) * -3));
        opacity: 1;
      }

      6.888888888888888%,
      8.090277777777779% {
        transform: translateY(calc(var(--ticker-height) * -4));
        opacity: 1;
      }

      8.506944444444445%,
      9.708333333333334% {
        transform: translateY(calc(var(--ticker-height) * -5));
        opacity: 1;
      }

      10.125%,
      11.32638888888889% {
        transform: translateY(calc(var(--ticker-height) * -6));
        opacity: 1;
      }

      11.743055555555555%,
      12.944444444444445% {
        transform: translateY(calc(var(--ticker-height) * -7));
        opacity: 1;
      }

      13.36111111111111%,
      14.5625% {
        transform: translateY(calc(var(--ticker-height) * -8));
        opacity: 1;
      }

      14.979166666666666%,
      16.180555555555554% {
        transform: translateY(calc(var(--ticker-height) * -9));
        opacity: 1;
      }

      16.59722222222222%,
      17.79861111111111% {
        transform: translateY(calc(var(--ticker-height) * -10));
        opacity: 1;
      }

      18.21527777777778%,
      19.416666666666668% {
        transform: translateY(calc(var(--ticker-height) * -11));
        opacity: 1;
      }

      19.833333333333336%,
      21.034722222222225% {
        transform: translateY(calc(var(--ticker-height) * -12));
        opacity: 1;
      }

      21.451388888888893%,
      22.652777777777782% {
        transform: translateY(calc(var(--ticker-height) * -13));
        opacity: 1;
      }

      23.06944444444445%,
      24.27083333333334% {
        transform: translateY(calc(var(--ticker-height) * -14));
        opacity: 1;
      }

      24.687500000000007%,
      25.888888888888896% {
        transform: translateY(calc(var(--ticker-height) * -15));
        opacity: 1;
      }

      26.305555555555564%,
      27.506944444444454% {
        transform: translateY(calc(var(--ticker-height) * -16));
        opacity: 1;
      }

      27.92361111111112%,
      29.12500000000001% {
        transform: translateY(calc(var(--ticker-height) * -17));
        opacity: 1;
      }

      29.54166666666668%,
      30.743055555555568% {
        transform: translateY(calc(var(--ticker-height) * -18));
        opacity: 1;
      }

      31.159722222222236%,
      32.36111111111112% {
        transform: translateY(calc(var(--ticker-height) * -19));
        opacity: 1;
      }

      32.777777777777786%,
      33.97916666666667% {
        transform: translateY(calc(var(--ticker-height) * -20));
        opacity: 1;
      }

      34.395833333333336%,
      35.59722222222222% {
        transform: translateY(calc(var(--ticker-height) * -21));
        opacity: 1;
      }

      36.013888888888886%,
      37.21527777777777% {
        transform: translateY(calc(var(--ticker-height) * -22));
        opacity: 1;
      }

      37.631944444444436%,
      38.83333333333332% {
        transform: translateY(calc(var(--ticker-height) * -23));
        opacity: 1;
      }

      39.249999999999986%,
      40.45138888888887% {
        transform: translateY(calc(var(--ticker-height) * -24));
        opacity: 1;
      }

      40.868055555555536%,
      42.06944444444442% {
        transform: translateY(calc(var(--ticker-height) * -25));
        opacity: 1;
      }

      42.486111111111086%,
      43.68749999999997% {
        transform: translateY(calc(var(--ticker-height) * -26));
        opacity: 1;
      }

      44.104166666666636%,
      45.30555555555552% {
        transform: translateY(calc(var(--ticker-height) * -27));
        opacity: 1;
      }

      45.722222222222186%,
      46.92361111111107% {
        transform: translateY(calc(var(--ticker-height) * -28));
        opacity: 1;
      }

      47.340277777777736%,
      48.54166666666662% {
        transform: translateY(calc(var(--ticker-height) * -29));
        opacity: 1;
      }

      48.958333333333286%,
      50.15972222222217% {
        transform: translateY(calc(var(--ticker-height) * -30));
        opacity: 1;
      }

      50.576388888888836%,
      51.77777777777772% {
        transform: translateY(calc(var(--ticker-height) * -31));
        opacity: 1;
      }

      52.194444444444386%,
      53.39583333333327% {
        transform: translateY(calc(var(--ticker-height) * -32));
        opacity: 1;
      }

      53.812499999999936%,
      55.01388888888882% {
        transform: translateY(calc(var(--ticker-height) * -33));
        opacity: 1;
      }

      55.430555555555486%,
      56.63194444444437% {
        transform: translateY(calc(var(--ticker-height) * -34));
        opacity: 1;
      }

      57.048611111111036%,
      58.24999999999992% {
        transform: translateY(calc(var(--ticker-height) * -35));
        opacity: 1;
      }

      58.666666666666586%,
      59.86805555555547% {
        transform: translateY(calc(var(--ticker-height) * -36));
        opacity: 1;
      }

      60.284722222222136%,
      61.48611111111102% {
        transform: translateY(calc(var(--ticker-height) * -37));
        opacity: 1;
      }

      61.902777777777686%,
      63.10416666666657% {
        transform: translateY(calc(var(--ticker-height) * -38));
        opacity: 1;
      }

      63.520833333333236%,
      64.72222222222211% {
        transform: translateY(calc(var(--ticker-height) * -39));
        opacity: 1;
      }

      65.13888888888879%,
      66.34027777777767% {
        transform: translateY(calc(var(--ticker-height) * -40));
        opacity: 1;
      }

      66.75694444444434%,
      67.95833333333323% {
        transform: translateY(calc(var(--ticker-height) * -41));
        opacity: 1;
      }

      68.3749999999999%,
      69.57638888888879% {
        transform: translateY(calc(var(--ticker-height) * -42));
        opacity: 1;
      }

      69.99305555555546%,
      71.19444444444434% {
        transform: translateY(calc(var(--ticker-height) * -43));
        opacity: 1;
      }

      71.61111111111101%,
      72.8124999999999% {
        transform: translateY(calc(var(--ticker-height) * -44));
        opacity: 1;
      }

      73.22916666666657%,
      74.43055555555546% {
        transform: translateY(calc(var(--ticker-height) * -45));
        opacity: 1;
      }

      74.84722222222213%,
      76.04861111111101% {
        transform: translateY(calc(var(--ticker-height) * -46));
        opacity: 1;
      }

      76.46527777777769%,
      77.66666666666657% {
        transform: translateY(calc(var(--ticker-height) * -47));
        opacity: 1;
      }

      78.08333333333324%,
      79.28472222222213% {
        transform: translateY(calc(var(--ticker-height) * -48));
        opacity: 1;
      }

      79.7013888888888%,
      80.90277777777769% {
        transform: translateY(calc(var(--ticker-height) * -49));
        opacity: 1;
      }

      81.31944444444436%,
      82.52083333333324% {
        transform: translateY(calc(var(--ticker-height) * -50));
        opacity: 1;
      }

      82.93749999999991%,
      84.1388888888888% {
        transform: translateY(calc(var(--ticker-height) * -51));
        opacity: 1;
      }

      84.55555555555547%,
      85.75694444444436% {
        transform: translateY(calc(var(--ticker-height) * -52));
        opacity: 1;
      }

      86.17361111111103%,
      87.37499999999991% {
        transform: translateY(calc(var(--ticker-height) * -53));
        opacity: 1;
      }

      87.79166666666659%,
      88.99305555555547% {
        transform: translateY(calc(var(--ticker-height) * -54));
        opacity: 1;
      }

      89.40972222222214%,
      90.61111111111103% {
        transform: translateY(calc(var(--ticker-height) * -55));
        opacity: 1;
      }

      91.0277777777777%,
      92.22916666666659% {
        transform: translateY(calc(var(--ticker-height) * -56));
        opacity: 1;
      }

      92.64583333333326%,
      93.84722222222214% {
        transform: translateY(calc(var(--ticker-height) * -57));
        opacity: 1;
      }

      94.26388888888881%,
      95.4652777777777% {
        transform: translateY(calc(var(--ticker-height) * -58));
        opacity: 1;
      }

      95.88194444444437%,
      97.08333333333326% {
        transform: translateY(calc(var(--ticker-height) * -59));
        opacity: 1;
      }

      97.49999999999993%,
      98.70138888888881% {
        transform: translateY(calc(var(--ticker-height) * -60));
        opacity: 1;
      }

      100% {
        transform: translateY(calc(var(--ticker-height) * -60));
        opacity: 0;
      }

    }

    /* generated by calc-keyframes.py */
    @keyframes vertical-scroll-36 {
      0% {
        transform: translateY(calc(var(--ticker-height) * 1));
        opacity: 0;
      }

      0.41666666666666663%,
      2.635030864197531% {
        transform: translateY(calc(var(--ticker-height) * -0));
        opacity: 1;
      }

      3.0516975308641974%,
      5.270061728395062% {
        transform: translateY(calc(var(--ticker-height) * -1));
        opacity: 1;
      }

      5.686728395061729%,
      7.9050925925925934% {
        transform: translateY(calc(var(--ticker-height) * -2));
        opacity: 1;
      }

      8.32175925925926%,
      10.540123456790123% {
        transform: translateY(calc(var(--ticker-height) * -3));
        opacity: 1;
      }

      10.95679012345679%,
      13.175154320987653% {
        transform: translateY(calc(var(--ticker-height) * -4));
        opacity: 1;
      }

      13.59182098765432%,
      15.810185185185183% {
        transform: translateY(calc(var(--ticker-height) * -5));
        opacity: 1;
      }

      16.22685185185185%,
      18.445216049382715% {
        transform: translateY(calc(var(--ticker-height) * -6));
        opacity: 1;
      }

      18.861882716049383%,
      21.080246913580247% {
        transform: translateY(calc(var(--ticker-height) * -7));
        opacity: 1;
      }

      21.496913580246915%,
      23.71527777777778% {
        transform: translateY(calc(var(--ticker-height) * -8));
        opacity: 1;
      }

      24.131944444444446%,
      26.35030864197531% {
        transform: translateY(calc(var(--ticker-height) * -9));
        opacity: 1;
      }

      26.766975308641978%,
      28.985339506172842% {
        transform: translateY(calc(var(--ticker-height) * -10));
        opacity: 1;
      }

      29.40200617283951%,
      31.620370370370374% {
        transform: translateY(calc(var(--ticker-height) * -11));
        opacity: 1;
      }

      32.03703703703704%,
      34.255401234567906% {
        transform: translateY(calc(var(--ticker-height) * -12));
        opacity: 1;
      }

      34.67206790123457%,
      36.89043209876544% {
        transform: translateY(calc(var(--ticker-height) * -13));
        opacity: 1;
      }

      37.3070987654321%,
      39.52546296296297% {
        transform: translateY(calc(var(--ticker-height) * -14));
        opacity: 1;
      }

      39.94212962962963%,
      42.1604938271605% {
        transform: translateY(calc(var(--ticker-height) * -15));
        opacity: 1;
      }

      42.577160493827165%,
      44.79552469135803% {
        transform: translateY(calc(var(--ticker-height) * -16));
        opacity: 1;
      }

      45.2121913580247%,
      47.430555555555564% {
        transform: translateY(calc(var(--ticker-height) * -17));
        opacity: 1;
      }

      47.84722222222223%,
      50.065586419753096% {
        transform: translateY(calc(var(--ticker-height) * -18));
        opacity: 1;
      }

      50.48225308641976%,
      52.70061728395063% {
        transform: translateY(calc(var(--ticker-height) * -19));
        opacity: 1;
      }

      53.11728395061729%,
      55.33564814814816% {
        transform: translateY(calc(var(--ticker-height) * -20));
        opacity: 1;
      }

      55.752314814814824%,
      57.97067901234569% {
        transform: translateY(calc(var(--ticker-height) * -21));
        opacity: 1;
      }

      58.387345679012356%,
      60.60570987654322% {
        transform: translateY(calc(var(--ticker-height) * -22));
        opacity: 1;
      }

      61.02237654320989%,
      63.240740740740755% {
        transform: translateY(calc(var(--ticker-height) * -23));
        opacity: 1;
      }

      63.65740740740742%,
      65.87577160493828% {
        transform: translateY(calc(var(--ticker-height) * -24));
        opacity: 1;
      }

      66.29243827160495%,
      68.51080246913583% {
        transform: translateY(calc(var(--ticker-height) * -25));
        opacity: 1;
      }

      68.9274691358025%,
      71.14583333333337% {
        transform: translateY(calc(var(--ticker-height) * -26));
        opacity: 1;
      }

      71.56250000000004%,
      73.78086419753092% {
        transform: translateY(calc(var(--ticker-height) * -27));
        opacity: 1;
      }

      74.19753086419759%,
      76.41589506172846% {
        transform: translateY(calc(var(--ticker-height) * -28));
        opacity: 1;
      }

      76.83256172839513%,
      79.05092592592601% {
        transform: translateY(calc(var(--ticker-height) * -29));
        opacity: 1;
      }

      79.46759259259268%,
      81.68595679012356% {
        transform: translateY(calc(var(--ticker-height) * -30));
        opacity: 1;
      }

      82.10262345679023%,
      84.3209876543211% {
        transform: translateY(calc(var(--ticker-height) * -31));
        opacity: 1;
      }

      84.73765432098777%,
      86.95601851851865% {
        transform: translateY(calc(var(--ticker-height) * -32));
        opacity: 1;
      }

      87.37268518518532%,
      89.5910493827162% {
        transform: translateY(calc(var(--ticker-height) * -33));
        opacity: 1;
      }

      90.00771604938286%,
      92.22608024691374% {
        transform: translateY(calc(var(--ticker-height) * -34));
        opacity: 1;
      }

      92.64274691358041%,
      94.86111111111128% {
        transform: translateY(calc(var(--ticker-height) * -35));
        opacity: 1;
      }

      95.27777777777796%,
      97.49614197530883% {
        transform: translateY(calc(var(--ticker-height) * -36));
        opacity: 1;
      }

      100% {
        transform: translateY(calc(var(--ticker-height) * -36));
        opacity: 0;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="league vertical-scroll-3">
      <div class="league-logo-container border-right"><img src="https://i.imgur.com/TaKg7Kt.png" class="league-logo"
          id="logo"></div>
      <div class="league-logo-container border-right"><img src="https://i.imgur.com/xmunM5b.png" class="league-logo"
          id="logo"></div>
      <div class="league-logo-container border-right"><img src="https://i.imgur.com/6e0NYVE.png" class="league-logo"
          id="logo"></div>
    </div>
    <div class="score-box"></div>
    <div class="marquee border-left">3</div>
  </div>

  <script type="module">
    // external URLs
    const xblBoxScoresUrl = "https://sheets.googleapis.com/v4/spreadsheets/1x5vwIVqk3-vEypu6dQb9Vb3kzVl9i2tA_zTcDK4I9LU/values/Box%20Scores?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const xblStandingsUrl = "https://sheets.googleapis.com/v4/spreadsheets/1x5vwIVqk3-vEypu6dQb9Vb3kzVl9i2tA_zTcDK4I9LU/values/Standings?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const xblHittingUrl = "https://sheets.googleapis.com/v4/spreadsheets/1x5vwIVqk3-vEypu6dQb9Vb3kzVl9i2tA_zTcDK4I9LU/values/Hitting?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const xblPitchingUrl = "https://sheets.googleapis.com/v4/spreadsheets/1x5vwIVqk3-vEypu6dQb9Vb3kzVl9i2tA_zTcDK4I9LU/values/Pitching?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaaBoxScoresUrl = "https://sheets.googleapis.com/v4/spreadsheets/1Dq7fLYeqsvAbwljnzcyhNQ4s2bDeaZky1pQeSJQdAps/values/Box%20Scores?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaaStandingsUrl = "https://sheets.googleapis.com/v4/spreadsheets/1Dq7fLYeqsvAbwljnzcyhNQ4s2bDeaZky1pQeSJQdAps/values/Standings?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaaHittingUrl = "https://sheets.googleapis.com/v4/spreadsheets/1Dq7fLYeqsvAbwljnzcyhNQ4s2bDeaZky1pQeSJQdAps/values/Hitting?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaaPitchingUrl = "https://sheets.googleapis.com/v4/spreadsheets/1Dq7fLYeqsvAbwljnzcyhNQ4s2bDeaZky1pQeSJQdAps/values/Pitching?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaBoxScoresUrl = "https://sheets.googleapis.com/v4/spreadsheets/14HmPir8MqsTyQE4BF3nxZVjsJL1MFACto4RDpH9eKqQ/values/Box%20Scores?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaStandingsUrl = "https://sheets.googleapis.com/v4/spreadsheets/14HmPir8MqsTyQE4BF3nxZVjsJL1MFACto4RDpH9eKqQ/values/Standings?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaHittingUrl = "https://sheets.googleapis.com/v4/spreadsheets/14HmPir8MqsTyQE4BF3nxZVjsJL1MFACto4RDpH9eKqQ/values/Hitting?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const aaPitchingUrl = "https://sheets.googleapis.com/v4/spreadsheets/14HmPir8MqsTyQE4BF3nxZVjsJL1MFACto4RDpH9eKqQ/values/Pitching?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";
    const logosUrl = "https://sheets.googleapis.com/v4/spreadsheets/1sMuZIiKGNxOG816mBpdYCHyogIlet_XPMBzF8YWFUus/values/Sheet1?key=AIzaSyA0I_neFlMHnG6lOpQhmuoEad3kHCcQCc4";

    const xblLogoUrl = "https://i.imgur.com/TaKg7Kt.png";
    const aaaLogoUrl = "https://i.imgur.com/xmunM5b.png";
    const aaLogoUrl = "https://i.imgur.com/6e0NYVE.png";


    // key page elements
    const DIV_SCOREBOX = document.querySelector(".score-box");


    // data
    let teamLogos = {};

    let recentXBLScores = [];
    let recentAAAScores = [];
    let recentAAScores = [];

    let xblStandings = {};
    let aaaStandings = {};
    let aaStandings = {};

    let xblHrLeaders = [];
    let aaaHrLeaders = [];
    let aaHrLeaders = [];

    let xblBaLeaders = [];
    let aaaBaLeaders = [];
    let aaBaLeaders = [];

    let xblKLeaders = [];
    let aaaKLeaders = [];
    let aaKLeaders = [];

    async function refreshData() {
      let dataPromises = [];

      const requests = {
        [xblBoxScoresUrl]: (json) => { recentXBLScores = populateScores(json); },
        [xblStandingsUrl]: (json) => { xblStandings = populateStandings(json); },
        [xblHittingUrl]: (json) => { xblHrLeaders = populateStatLeaders(json, 7); xblBaLeaders = populateStatLeaders(json, 2); },
        [xblPitchingUrl]: (json) => { xblKLeaders = populateStatLeaders(json, 9); },
        [aaaBoxScoresUrl]: (json) => { recentAAAScores = populateScores(json); },
        [aaaStandingsUrl]: (json) => { aaaStandings = populateStandings(json); },
        [aaaHittingUrl]: (json) => { aaaHrLeaders = populateStatLeaders(json, 7); aaaBaLeaders = populateStatLeaders(json, 2); },
        [aaaPitchingUrl]: (json) => { aaaKLeaders = populateStatLeaders(json, 9); },
        [aaBoxScoresUrl]: (json) => { recentAAScores = populateScores(json); },
        [aaStandingsUrl]: (json) => { aaStandings = populateStandings(json, true); },
        [aaHittingUrl]: (json) => { aaHrLeaders = populateStatLeaders(json, 7); aaBaLeaders = populateStatLeaders(json, 2); },
        [aaPitchingUrl]: (json) => { aaKLeaders = populateStatLeaders(json, 9); },
      };

      for (const [url, process] of Object.entries(requests)) {
        dataPromises.push(
          fetch(url, { "method": "GET" })
            .then((response) => { return response.json(); })
            .then((json) => process(json))
        );
      }

      dataPromises.push(
        fetch(logosUrl, { "method": "GET" })
          .then((response) => { return response.json(); })
          .then((json) => {
            for (let i = 1; i < json.values.length; i++) {
              const team1 = json.values[i][0];
              const teamLogoUrl1 = json.values[i][1];
              const team2 = json.values[i][2];
              const teamLogoUrl2 = json.values[i][3];
              const team3 = json.values[i][4];
              const teamLogoUrl3 = json.values[i][5];
              teamLogos = {
                ...teamLogos,
                [`${team1}`]: teamLogoUrl1,
                [`${team2}`]: teamLogoUrl2,
                [`${team3}`]: teamLogoUrl3
              };
            }
          })
      );

      return await Promise.all(dataPromises);
    }

    function populateScores(json) {
      let scores = [];
      let gameIndex = json.values.length - 1;
      for (let i = 0; i < 6; i++) {
        const boxScore = json.values[gameIndex];

        scores[i] = {
          awayTeam: boxScore[1],
          awayScore: boxScore[2],
          homeScore: boxScore[3],
          homeTeam: boxScore[4]
        };

        gameIndex--;
      }
      return scores;
    }

    function populateStandings(json, isAA) {
      let standings = {};
      for (let i = 1; i < json.values.length; i++) {
        const rank = json.values[i][0];
        const team = json.values[i][1];
        const wins = json.values[i][isAA ? 4 : 2];
        const losses = json.values[i][isAA ? 5 : 3];
        standings = {
          ...standings,
          [`${team}`]: { rank, wins, losses }
        }
      }
      return standings;
    }

    // Row 2 of hitting = BA
    // Row 7 of hitting = HRs
    // Row 9 of pitching = Ks
    function populateStatLeaders(json, statRowIndex) {
      const parseFloat = statRowIndex === 2;
      let statLeaders = [];
      for (let i = 1; i < json.values.length; i++) {
        const row = json.values[i];
        statLeaders[i] = {
          team: row[1],
          value: parseFloat ? Number.parseFloat(row[statRowIndex]) : Number.parseInt(row[statRowIndex])
        }
      }

      const sortedLeaders = statLeaders
        .sort((a, b) => b.value - a.value)
        .slice(0, 10);

      if (parseFloat) {
        return sortedLeaders.map(l => ({
          team: l.team,
          value: String(l.value.toFixed(3)).slice(String(l.value.toFixed(3)).indexOf('.'))
        }))
      }

      return sortedLeaders;
    }


    const makeTeam = (name = "Unknown", record = "0-0", score = "0", away = false, winner = false) => {
      const team = document.createElement("div");
      team.classList.add("team");
      if (away) {
        team.classList.add("border-right");
      }

      if (winner) {
        team.classList.add("winner");
      }

      const teamHtmlFragment = `
        <div class="team-info">
          <div class="team-logo"><img src="${teamLogos[name]}" style="max-width: 28px;"></div>
          <div class="team-name">${name}</div>
          <div class="team-record">(${record})</div>
        </div>
        <div class="score">${score}</div>
      `;

      team.innerHTML = teamHtmlFragment;

      return team;
    }

    const makeMatchup = (awayTeam, awayScore, homeTeam, homeScore) => {
      const matchup = document.createElement("div");
      matchup.classList.add("matchup");

      matchup.appendChild(makeTeam(awayTeam, "0-0", awayScore, true, +awayScore > +homeScore));
      matchup.appendChild(makeTeam(homeTeam, "0-0", homeScore, false, +homeScore > +awayScore));

      return matchup;
    }

    const addScore = (matchup) => {
      DIV_SCOREBOX.appendChild(matchup);
    }

    await refreshData();

    // add every game twice in a loop
    for (let i = 0; i < recentXBLScores.length * 2; i++) {
      const game = recentXBLScores[i % recentXBLScores.length];
      const matchup = makeMatchup(game['awayTeam'], game['awayScore'], game['homeTeam'], game['homeScore']);
      addScore(matchup);
    }

    for (let i = 0; i < recentAAAScores.length * 2; i++) {
      const game = recentAAAScores[i % recentAAAScores.length];
      const matchup = makeMatchup(game['awayTeam'], game['awayScore'], game['homeTeam'], game['homeScore']);
      addScore(matchup);
    }

    for (let i = 0; i < recentAAScores.length * 2; i++) {
      const game = recentAAScores[i % recentAAScores.length];
      const matchup = makeMatchup(game['awayTeam'], game['awayScore'], game['homeTeam'], game['homeScore']);
      addScore(matchup);
    }

    DIV_SCOREBOX.classList.add(`vertical-scroll-${DIV_SCOREBOX.childNodes.length}`);
  </script>
</body>

</html>